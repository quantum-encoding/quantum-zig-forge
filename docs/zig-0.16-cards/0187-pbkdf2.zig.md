# Migration Card: `std/crypto/pbkdf2.zig`

## 1) Concept

This file implements the PBKDF2 (Password-Based Key Derivation Function 2) algorithm as defined in RFC 2898. PBKDF2 is a key derivation function that applies a pseudorandom function (such as HMAC) to a password along with a salt and repeats the process many times to produce a derived key. The primary purpose is to make key derivation computationally expensive to resist brute-force attacks.

The key components include the main `pbkdf2` function that implements the core algorithm, along with comprehensive test vectors from RFC 6070. The implementation handles password and salt inputs of arbitrary length, supports configurable iteration counts, and works with any pseudorandom function type that follows the expected interface (having `init`, `update`, `final`, and `create` methods).

## 2) The 0.11 vs 0.16 Diff

**No significant migration changes detected** - this API follows consistent patterns across Zig versions:

- **No explicit allocator requirements**: The function operates on pre-allocated output buffers provided by the caller
- **No I/O interface changes**: Pure computational function with no I/O dependencies
- **Error handling consistency**: Uses specific error types (`WeakParametersError`, `OutputTooLongError`) that were likely present in similar form in 0.11
- **API structure stability**: Simple function-based API without struct initialization patterns

The function signature remains clean and allocation-free:
```zig
pub fn pbkdf2(dk: []u8, password: []const u8, salt: []const u8, rounds: u32, comptime Prf: type) (WeakParametersError || OutputTooLongError)!void
```

## 3) The Golden Snippet

```zig
const std = @import("std");
const pbkdf2 = std.crypto.pbkdf2.pbkdf2;
const HmacSha1 = std.crypto.auth.hmac.HmacSha1;

// Derive a 20-byte key using PBKDF2 with HMAC-SHA1
var derived_key: [20]u8 = undefined;
try pbkdf2(
    &derived_key,           // Output buffer
    "my_password",          // Password  
    "salt_value",           // Salt
    4096,                   // Iteration count
    HmacSha1                // Pseudorandom function type
);
```

## 4) Dependencies

- `std.mem` - For memory operations and byte conversions
- `std.math` - For mathematical operations and bounds checking
- `std.crypto.errors` - For specific error types (`OutputTooLongError`, `WeakParametersError`)
- `std.crypto.auth.hmac` - For HMAC implementations (used in tests)
- `std.debug` - For compile-time assertions

**Note**: The primary dependency is on the pseudorandom function type parameter (`Prf`), which must provide:
- `mac_length` constant
- `init(password: []const u8)` method
- `update(data: []const u8)` method  
- `final(output: []u8)` method
- `create(output: []u8, message: []const u8, key: []const u8)` function