# Migration Card: std/crypto/25519/ed25519.zig

## 1) Concept

This file implements Ed25519 (EdDSA) digital signatures using the Edwards-curve Digital Signature Algorithm. It provides a comprehensive cryptographic signature system including key generation, signing, verification, batch verification, and key blinding capabilities. The main components include:

- **KeyPair**: For generating and managing Ed25519 key pairs (public/private keys)
- **SecretKey** and **PublicKey**: Individual key management with encoding/decoding
- **Signature**: Digital signature creation and verification
- **Signer** and **Verifier**: Incremental signing and verification interfaces
- **Batch verification**: Efficient verification of multiple signatures
- **Key blinding**: Support for blinded keys as used in privacy-preserving protocols

The implementation follows RFC 8032 standards and provides both cofactored and cofactorless verification modes for compatibility and security.

## 2) The 0.11 vs 0.16 Diff

### Explicit Allocator Requirements
- **No allocator dependencies**: This crypto module is entirely allocation-free. All operations work with fixed-size buffers and do not require memory allocators.
- **Fixed-size arrays**: All key and signature operations use compile-time known sizes (`[32]u8`, `[64]u8`, etc.)

### I/O Interface Changes
- **No I/O dependencies**: The module is purely computational and doesn't involve file or network I/O
- **Streaming interfaces**: Uses incremental `Signer` and `Verifier` patterns for large message processing

### Error Handling Changes
- **Specific error types**: Uses granular error sets from `crypto.errors`:
  ```zig
  const EncodingError = crypto.errors.EncodingError;
  const IdentityElementError = crypto.errors.IdentityElementError;
  const NonCanonicalError = crypto.errors.NonCanonicalError;
  const SignatureVerificationError = crypto.errors.SignatureVerificationError;
  const KeyMismatchError = crypto.errors.KeyMismatchError;
  const WeakPublicKeyError = crypto.errors.WeakPublicKeyError;
  ```
- **Composed error sets**: Functions return error unions with specific combinations like `Verifier.InitError` and `Verifier.VerifyError`

### API Structure Changes
- **Factory patterns**: Consistent use of `fromBytes()` and `toBytes()` for serialization
- **Deterministic generation**: `generateDeterministic()` for seed-based key generation
- **Incremental interfaces**: `Signer` and `Verifier` structs for streaming operations
- **Batch verification**: Generic `verifyBatch()` function with compile-time count

## 3) The Golden Snippet

```zig
const std = @import("std");
const Ed25519 = std.crypto.25519.ed25519.Ed25519;

// Generate a new key pair
const key_pair = Ed25519.KeyPair.generate();

// Sign a message
const message = "Hello, Ed25519!";
const signature = try key_pair.sign(message, null);

// Verify the signature
try signature.verify(message, key_pair.public_key);

// Alternative: Use incremental signing
var signer = try key_pair.signer(null);
signer.update("Hello, ");
signer.update("Ed25519!");
const incremental_sig = signer.finalize();

// Alternative: Use incremental verification  
var verifier = try incremental_sig.verifier(key_pair.public_key);
verifier.update("Hello, ");
verifier.update("Ed25519!");
try verifier.verify();
```

## 4) Dependencies

- **std.crypto**: Core cryptographic primitives and error definitions
- **std.mem**: For memory comparison operations (`mem.eql`)
- **std.crypto.hash.sha2.Sha512**: Hash function used in Ed25519 operations
- **std.crypto.ecc.Edwards25519**: Underlying elliptic curve implementation
- **std.crypto.random**: Cryptographically secure random number generation
- **std.debug**: Runtime safety checks (conditional compilation)

**Note**: This module has no external dependencies beyond the Zig standard library and is designed to be allocation-free for security-critical applications.