# Migration Card: `std/os/linux/x86.zig`

## 1) Concept

This file provides low-level x86 (32-bit) Linux system call interfaces for Zig. It contains inline assembly implementations of system call wrappers (`syscall0` through `syscall6`) that use the `int 0x80` interrupt mechanism to invoke Linux system calls. The file also includes specialized functions for thread cloning (`clone`), signal handling restoration (`restore`, `restore_rt`), and socket operations via `socketcall`.

Key components include system call wrappers for different argument counts, x86-specific assembly implementations, type definitions for Linux system structures (like `Stat`), and constants for socket operations and VDSO (Virtual Dynamic Shared Object) symbols.

## 2) The 0.11 vs 0.16 Diff

**No significant public API migration changes detected.** This file contains low-level system call interfaces that remain stable:

- **System call functions** (`syscall0`-`syscall6`, `socketcall`) maintain identical signatures - they take system call numbers and raw integer arguments, returning raw system call results
- **No allocator requirements** - these are direct system call wrappers that don't allocate memory
- **No I/O interface changes** - these functions operate at the system call level, below any I/O abstraction
- **Error handling unchanged** - functions return raw `u32` system call results, leaving error interpretation to callers
- **Specialized functions** (`clone`, `restore`, `restore_rt`) use `callconv(.naked)` and assembly, remaining stable across versions
- **Type definitions** (`Stat`, `user_desc`, etc.) maintain their structure and field layouts

The primary change is internal: use of `@intFromEnum(SYS.enum_value)` instead of direct integer constants, but this doesn't affect public API usage.

## 3) The Golden Snippet

```zig
const std = @import("std");
const x86 = std.os.linux.x86;

// Example: Using syscall3 to read from a file descriptor
pub fn example_read(fd: u32, buffer: [*]u8, count: u32) u32 {
    return x86.syscall3(.read, fd, @intFromPtr(buffer), count);
}

// Example: Using socketcall for socket operations
pub fn example_socket() u32 {
    const args = [3]u32{
        std.os.linux.AF_INET,
        std.os.linux.SOCK_STREAM,
        0, // protocol
    };
    return x86.socketcall(x86.SC.socket, &args);
}
```

## 4) Dependencies

- `std` - Primary standard library import
- `builtin` - For target-specific configuration (backend type, unwind tables, debug info)
- `std.os.linux.SYS` - System call number enumeration
- `std.os.linux` types (`timespec`, `uid_t`, `gid_t`) - For structure definitions

This file has minimal external dependencies and focuses purely on x86 Linux system call mechanics.