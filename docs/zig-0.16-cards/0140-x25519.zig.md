# Migration Card: X25519 Implementation

## 1) Concept

This file implements the X25519 Diffie-Hellman function using Curve25519 for key exchange. It provides functionality for generating X25519 key pairs (both randomly and deterministically), converting between Ed25519 and X25519 key formats, and performing scalar multiplication for shared secret computation. The implementation includes proper handling of edge cases like identity elements and weak public keys through specific error types.

Key components include:
- `X25519` struct containing core DH operations
- `KeyPair` struct with generation methods
- Public functions for key recovery, format conversion, and scalar multiplication
- Comprehensive test vectors from RFC 7748

## 2) The 0.11 vs 0.16 Diff

**No significant API changes detected** - this crypto module maintains consistent patterns:

- **No explicit allocator requirements**: All operations work with fixed-size arrays, no dynamic allocation needed
- **No I/O interface changes**: Pure computational functions without I/O dependencies
- **Error handling consistency**: Uses specific error types (`IdentityElementError`, `EncodingError`) rather than generic errors
- **API structure stability**: Factory functions like `generate()` and `generateDeterministic()` follow consistent patterns
- **Memory management**: All buffers are stack-allocated fixed arrays, no allocator injection needed

The API signatures remain stable with fixed-size byte arrays and specific error sets, aligning with Zig's crypto module design principles.

## 3) The Golden Snippet

```zig
const std = @import("std");
const X25519 = std.crypto.curve25519.X25519;

// Generate a random X25519 key pair
const key_pair = X25519.KeyPair.generate();

// Compute shared secret with another party's public key
const other_public_key = [32]u8{0x90} ** 32; // Example public key
const shared_secret = try X25519.scalarmult(key_pair.secret_key, other_public_key);

// Recover public key from secret key (useful for deterministic key generation)
const recovered_public = try X25519.recoverPublicKey(key_pair.secret_key);
```

## 4) Dependencies

- `std.crypto` - Core cryptographic primitives
- `std.crypto.hash.sha2.Sha512` - Hash function for key derivation
- `std.crypto.sign.Ed25519` - Ed25519 signature scheme for key conversion
- `std.crypto.ecc.Edwards25519` - Edwards curve operations
- `std.mem` - Memory operations
- `std.fmt` - Formatting for test utilities

**Dependency Graph**: `crypto` → `hash`/`sign`/`ecc` → `mem`/`fmt`

This module has minimal external dependencies beyond the core crypto stack, making it highly portable and self-contained.