```markdown
# Migration Card: edwards25519.zig

## 1) Concept
This file defines the `Edwards25519` struct in Zig 0.16's `std.crypto`, implementing elliptic curve operations over the Edwards25519 curve (used in protocols like EdDSA and X25519). It provides projective extended coordinates (x, y, z, t) for efficient arithmetic, along with public constants (`basePoint`, `identityElement`), encoding/decoding (`fromBytes`, `toBytes`), canonicality checks (`rejectNonCanonical`, `rejectIdentity`, `rejectLowOrder`, `rejectUnexpectedSubgroup`), core operations (`add`, `sub`, `dbl`, `neg`, `clearCofactor`), scalar multiplications (`mul`, `mulPublic`, `clampedMul`, `mulDoubleBasePublic`, `mulMulti`), and hash-to-curve mappings (`fromHash`, `fromString`, `fromUniform`). Internal helpers (e.g., `pcMul`, `precompute`) support constant-time and variable-time computations, with precomputed tables for the base point.

The API emphasizes security (subgroup checks, clamping, weak key rejection) and performance (precomputation, windowed scalar mul), exposing only pure mathematical functions without allocators or I/O.

## 2) The 0.11 vs 0.16 Diff
This file introduces a self-contained `Edwards25519` struct with **static methods** (no implicit `self`; all ops take explicit point arg as first param, e.g., `Edwards25519.add(p, q)`). No explicit allocators or factory `init()`/`open()` patternsâ€”all points are value types created via `fromBytes`, `fromHash`, etc.

- **Error handling**: Specific union errors (e.g., `EncodingError!`, `WeakPublicKeyError!`, `(IdentityElementError || WeakPublicKeyError)!`) replace any generic `error{...}!` from 0.11; propagated via `try` in chains.
- **Scalar mul APIs**: New granular funcs like `mul(s: [32]u8)` (constant-time, unclamped), `mulPublic(s: [32]u8)` (variable-time), `clampedMul(s: [32]u8)` (clamps scalar); multi-scalar `mulMulti`, `mulDoubleBasePublic`. Base point uses optimized precomp (`basePointPc`).
- **Hash-to-curve**: New `fromString(random_oracle: bool, ctx: []const u8, s: []const u8)` (XMD:SHA-512-ELL2), `fromHash([64]u8)`, `fromUniform([32]u8)`.
- **Validation**: Static `reject*` funcs for canonical/identity/subgroup checks (e.g., `rejectUnexpectedSubgroup(p)` combines low-order + cofactor checks).
- No I/O or dep-injection changes (pure math). Signatures are input-checked with early returns; no optional alloc params.

0.11 likely had looser errors/generic structs; migrate by using explicit `try` on specific errors and static calls.

## 3) The Golden Snippet
```zig
const std = @import("std");
const crypto = std.crypto;

pub fn main() !void {
    const base = Edwards25519.basePoint;
    const scalar: [Edwards25519.encoded_length]u8 = .{170} ++ [_]u8{0} ** 31;
    const point = try base.mul(scalar);
    const encoded = point.toBytes();
    std.debug.print("{x}\n", .{encoded}); // Outputs: 074bc7e0fcbd587fdbc0969444245fadc562809c8f6e97e949af62484b5b81a6
}
```

## 4) Dependencies
- `std` (core, with subimports: `std.crypto`, `std.debug`, `std.fmt`, `std.mem`)
- Local: `"field.zig"` (as `Fe`), `"scalar.zig"` (as `scalar`)
- Tests: `crypto.hash.sha2.Sha512`, `"../test.zig"` (htest)
```
```