# Migration Analysis: P384 Test File

## 1) Concept
This is a test file for the P384 elliptic curve implementation in Zig's crypto library. It contains comprehensive unit tests that verify the correctness of P384 elliptic curve operations including ECDH key exchange, point operations, coordinate transformations, SEC1 encoding/decoding, and scalar arithmetic. The tests validate mathematical properties like point equivalence, neutral element handling, and test vector compliance with expected cryptographic standards.

## 2) The 0.11 vs 0.16 Diff
This test file demonstrates several Zig 0.16 patterns:

- **Error Handling Changes**: Uses explicit error handling with `try` and `testing.expectError` for specific error types like `error.IdentityElement`, `error.NonCanonical`, and `error.InvalidEncoding`

- **API Structure**: Shows consistent use of endianness parameters (`.little`, `.big`) in cryptographic operations and byte conversions

- **Method Chaining**: Uses fluent interface patterns like `p.affineCoordinates().x` and `p.equivalent(q)` rather than standalone functions

- **Factory Patterns**: Uses static methods like `P384.scalar.random()`, `P384.fromSerializedAffineCoordinates()`, and `P384.fromSec1()` rather than constructor functions

## 3) The Golden Snippet
```zig
test "p384 ECDH key exchange" {
    const dha = P384.scalar.random(.little);
    const dhb = P384.scalar.random(.little);
    const dhA = try P384.basePoint.mul(dha, .little);
    const dhB = try P384.basePoint.mul(dhb, .little);
    const shareda = try dhA.mul(dhb, .little);
    const sharedb = try dhB.mul(dha, .little);
    try testing.expect(shareda.equivalent(sharedb));
}
```

## 4) Dependencies
- `std.testing` - Test assertions and framework
- `std.fmt` - Hexadecimal string parsing (`hexToBytes`)
- `../p384.zig` - Main P384 elliptic curve implementation

**Note**: This is a test file that exercises the public P384 API but doesn't define the public API itself. The actual migration patterns would be found in the main `p384.zig` implementation file.