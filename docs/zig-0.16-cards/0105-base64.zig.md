# Base64 Migration Card

## 1) Concept
This file implements Base64 encoding and decoding as specified by RFC 4648. It provides a comprehensive Base64 implementation with support for both standard and URL-safe alphabets, with and without padding. The key components include:

- **Codecs struct**: Groups encoder/decoder pairs for different Base64 variants (standard, standard_no_pad, url_safe, url_safe_no_pad)
- **Base64Encoder**: Handles encoding binary data to Base64 text with configurable alphabet and padding
- **Base64Decoder**: Handles decoding Base64 text back to binary data with validation
- **Base64DecoderWithIgnore**: Extended decoder that can ignore specified characters during decoding

The implementation provides both high-level convenience codecs and low-level encoder/decoder instances for fine-grained control.

## 2) The 0.11 vs 0.16 Diff

### Explicit Allocator Requirements
- **No allocator dependencies**: All operations work with pre-allocated buffers
- **Buffer management**: Callers must provide destination buffers of appropriate size calculated via `calcSize()`/`calcSizeUpperBound()`
- **Memory efficiency**: Uses stack-allocated buffers and avoids heap allocations

### I/O Interface Changes
- **Writer-based encoding**: `encodeWriter()` method accepts `*std.Io.Writer` for streaming output
- **Buffer-based operations**: Primary APIs work with slices rather than streams
- **No file I/O dependencies**: Pure memory-to-memory operations

### Error Handling Changes
- **Specific error set**: `Error{InvalidCharacter, InvalidPadding, NoSpaceLeft}`
- **No generic error unions**: Operations return specific Base64 errors rather than generic I/O errors
- **Validation at boundaries**: Padding validation and character validation with precise error reporting

### API Structure Changes
- **Factory pattern**: Encoders/decoders created via `init()` with alphabet and padding configuration
- **Codec bundles**: Pre-configured `Codecs` instances for common variants
- **Stateless design**: Encoders/decoders are immutable after initialization

## 3) The Golden Snippet

```zig
const std = @import("std");
const base64 = std.base64;

pub fn main() !void {
    const input = "Hello, World!";
    
    // Encode using standard Base64 with padding
    var encode_buffer: [100]u8 = undefined;
    const encoded = base64.standard.Encoder.encode(&encode_buffer, input);
    
    // Decode back to original
    var decode_buffer: [100]u8 = undefined;
    const decoded_size = try base64.standard.Decoder.calcSizeForSlice(encoded);
    const decoded = decode_buffer[0..decoded_size];
    try base64.standard.Decoder.decode(decoded, encoded);
    
    std.debug.print("Original: {s}\n", .{input});
    std.debug.print("Encoded:  {s}\n", .{encoded});
    std.debug.print("Decoded:  {s}\n", .{decoded});
}
```

## 4) Dependencies
- **std.mem**: Used for memory operations, window utilities, and integer reading/writing
- **std.debug**: Used for assertions
- **std.Io**: Used for writer interface in `encodeWriter()`
- **builtin**: Used for compile-time configuration
- **std.testing**: Used exclusively in test code

**Note**: This module has minimal dependencies and focuses on pure Base64 transformation without external system dependencies.