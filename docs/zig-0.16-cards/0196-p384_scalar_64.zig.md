# Migration Card: P-384 Scalar Field Arithmetic

## 1) Concept

This file implements arithmetic operations for the P-384 elliptic curve's scalar field in Montgomery form. It provides low-level field operations including multiplication, addition, subtraction, negation, and conversions between Montgomery and non-Montgomery domain representations. The implementation uses 64-bit word-level arithmetic with Montgomery reduction for efficient modular arithmetic.

Key components:
- `MontgomeryDomainFieldElement` and `NonMontgomeryDomainFieldElement` types representing field elements
- Core arithmetic operations: `mul`, `square`, `add`, `sub`, `opp`
- Domain conversion functions: `fromMontgomery`, `toMontgomery`
- Utility functions: `nonzero`, `selectznz`, `toBytes`, `fromBytes`, `setOne`
- Specialized functions for inversion: `divstep`, `divstepPrecomp`

## 2) The 0.11 vs 0.16 Diff

**No Migration Changes Required**

This file contains low-level cryptographic arithmetic functions that follow consistent patterns across Zig versions:

- **No allocator requirements**: All functions operate on pre-allocated output buffers
- **No I/O interface changes**: Pure mathematical operations without I/O dependencies
- **No error handling changes**: Functions are side-effect free with no error returns
- **Consistent API structure**: Function signatures use simple pointer parameters and fixed-size arrays

The public API signatures remain stable:
- All functions take output pointer as first parameter
- Input parameters are passed by value as fixed-size arrays
- No memory allocation or deallocation within functions
- No dependency injection patterns

## 3) The Golden Snippet

```zig
const std = @import("std");
const p384_scalar = @import("std").crypto.pcurves.p384.p384_scalar_64;

// Multiply two field elements in Montgomery domain
pub fn example_usage() void {
    var a = p384_scalar.MontgomeryDomainFieldElement{ 0x123456789abcdef0, 0xfedcba9876543210, 0x13579bdf2468ace0, 0x1f3f5f7f9fbfdfef, 0x0, 0x0 };
    var b = p384_scalar.MontgomeryDomainFieldElement{ 0x1122334455667788, 0x99aabbccddeeff00, 0x1020304050607080, 0x90a0b0c0d0e0f000, 0x0, 0x0 };
    var result: p384_scalar.MontgomeryDomainFieldElement = undefined;
    
    p384_scalar.mul(&result, a, b);
    
    // result now contains a * b mod m in Montgomery domain
}
```

## 4) Dependencies

**Minimal Dependencies:**
- `std` (imported but unused in public API)
- `builtin.mode` (for runtime safety checks)

This is a self-contained arithmetic implementation with no external dependencies beyond the Zig standard library. The code performs all operations using fundamental integer arithmetic without requiring memory allocation, networking, or other complex standard library modules.

**Note:** This file is part of the cryptographic primitives and should be used through higher-level cryptographic APIs rather than directly.