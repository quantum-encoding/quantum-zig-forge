# Migration Card: Complex Square Root Implementation

## 1) Concept

This file implements complex square root functions for both 32-bit and 64-bit floating-point numbers. It's a mathematical utility module that calculates the square root of complex numbers, handling edge cases like infinity, NaN, and zero values appropriately. The implementation is ported from musl libc and provides type-generic functionality through a public `sqrt` function that dispatches to type-specific implementations (`sqrt32` and `sqrt64`).

Key components include:
- A public generic `sqrt` function that works with any complex number type
- Specialized implementations for `f32` and `f64` complex numbers
- Comprehensive edge case handling for mathematical corner cases
- Test cases validating the implementation correctness

## 2) The 0.11 vs 0.16 Diff

**Complex Number Construction Pattern Change:**
- **0.11 Pattern:** Likely used factory methods like `Complex(f32).new()` or similar constructor patterns
- **0.16 Pattern:** Uses `Complex(f32).init(real, imag)` consistently throughout the codebase

**Type System Enhancements:**
- Uses `@TypeOf(z.re, z.im)` for generic type deduction
- Explicit type casting with `@as(f64, x)` and `@floatCast()` for precision control
- Compile-time type checking with `@compileError` for unsupported types

**Mathematical Function Updates:**
- Uses newer standard library math functions like `math.hypot()`, `math.copysign()`, `math.isInf()`, `math.isNan()`
- Consistent use of `@abs()` instead of `std.math.fabs()` or similar

## 3) The Golden Snippet

```zig
const std = @import("std");
const math = std.math;
const Complex = math.complex.Complex;

// Calculate square root of a complex number
const a = Complex(f32).init(5, 3);
const result = math.complex.sqrt(a);

// result.re ≈ 2.3271174, result.im ≈ 0.6445742
```

## 4) Dependencies

- `std.math` - Core mathematical functions and constants
- `std.math.complex` - Complex number type definitions and operations
- `std.testing` - Testing framework for validation

**Key Mathematical Dependencies:**
- `math.hypot` - Euclidean distance calculation
- `math.copysign` - Sign copying operations
- `math.isInf` / `math.isNan` - Special value detection
- `math.signbit` - Sign bit inspection
- `math.floatEps` - Floating-point precision constants