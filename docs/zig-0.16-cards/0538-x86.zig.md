# Migration Card: `std/zig/system/x86.zig`

## 1) Concept

This file implements CPU feature detection and model identification for x86/x86_64 architectures. It's a low-level system component that analyzes CPUID instruction results to determine processor capabilities and map them to specific CPU models in Zig's target system. The key components include:

- CPUID leaf parsing for feature detection
- XCR0 (Extended Control Register) handling for AVX/AVX512 state management  
- Intel and AMD processor family/model identification logic
- Feature set population for the target CPU model

The file provides the foundational CPU detection that enables Zig's cross-compilation system to target specific x86 processor capabilities and optimizations.

## 2) The 0.11 vs 0.16 Diff

**No public API migration changes detected.** This file contains internal implementation functions for CPU detection:

- `detectNativeCpuAndFeatures()` is the only public function, but it's part of Zig's internal target detection system
- All other functions (`detectIntelProcessor`, `detectAMDProcessor`, `detectNativeFeatures`, `cpuid`, `getXCR0`) are private
- No allocator requirements - uses static detection only
- No I/O interface changes - uses inline assembly and CPUID instructions
- No error handling changes - all functions are non-failing
- No API structure changes (init vs open patterns)

The public function signature remains stable:
```zig
pub fn detectNativeCpuAndFeatures(arch: Target.Cpu.Arch, os: Target.Os, query: Target.Query) Target.Cpu
```

## 3) The Golden Snippet

```zig
const std = @import("std");
const Target = std.Target;

// This function is typically called internally by Zig's build system
// and target detection, not directly by user code
const native_cpu = std.zig.system.x86.detectNativeCpuAndFeatures(
    .x86_64, 
    .linux, 
    Target.Query{}
);
```

## 4) Dependencies

- `std` - Core standard library
- `builtin` - Compiler-builtin information
- `std.Target` - Target architecture and CPU model definitions

**SKIP: Internal implementation file - no public migration impact**

This file contains internal CPU detection logic used by Zig's compilation system. While it has one public function (`detectNativeCpuAndFeatures`), this is part of Zig's internal target detection infrastructure and not a public API that developers would typically use directly in their applications. The implementation focuses on low-level CPU feature detection through CPUID instructions and doesn't expose developer-facing APIs that would require migration.