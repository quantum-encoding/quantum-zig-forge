{
  "_comment": "warden-config.json - Guardian Shield Configuration",
  "_comment_purpose": "libwarden.so reads this file at initialization",
  "_comment_location": "Install to /etc/warden/warden-config.json (recommended)",
  "_comment_customize": "This is a minimal config protecting only system-critical paths.",
  "_comment_customize2": "To protect your projects: Add your paths to 'whitelisted_paths' or 'directory_protection.protected_roots'",
  "_comment_customize3": "Example user paths: '/home/username/projects/', '/home/username/sandbox/', etc.",

  "global": {
    "enabled": true,
    "log_level": "normal",
    "log_target": "stderr",
    "block_emoji": "üõ°Ô∏è",
    "warning_emoji": "‚ö†Ô∏è",
    "allow_emoji": "‚úì"
  },

  "protection": {
    "protected_paths": [
      {
        "path": "/etc/",
        "description": "System configuration files",
        "block_operations": ["unlink", "unlinkat", "rmdir", "open_write", "rename"]
      },
      {
        "path": "/boot/",
        "description": "Boot partition and kernel files",
        "block_operations": ["unlink", "unlinkat", "rmdir", "open_write", "rename"]
      },
      {
        "path": "/sys/",
        "description": "Kernel sysfs interface",
        "block_operations": ["unlink", "unlinkat", "rmdir", "open_write", "rename"]
      },
      {
        "path": "/proc/",
        "description": "Process filesystem (except /proc/self/*)",
        "block_operations": ["unlink", "unlinkat", "rmdir", "open_write", "rename"]
      },
      {
        "path": "/dev/sda",
        "description": "SATA block device",
        "block_operations": ["open_write"]
      },
      {
        "path": "/dev/nvme",
        "description": "NVMe block device",
        "block_operations": ["open_write"]
      },
      {
        "path": "/dev/vd",
        "description": "Virtual disk device",
        "block_operations": ["open_write"]
      },
      {
        "path": "/usr/lib/",
        "description": "System libraries",
        "block_operations": ["unlink", "unlinkat", "rmdir", "open_write"]
      },
      {
        "path": "/usr/bin/",
        "description": "System binaries",
        "block_operations": ["unlink", "unlinkat", "rmdir", "open_write"]
      }
    ],

    "whitelisted_paths": [
      {
        "path": "/proc/self/",
        "description": "Process-specific proc entries (required for normal operation)"
      },
      {
        "path": "/tmp/",
        "description": "System temporary directory (universal)"
      },
      {
        "path": "/var/tmp/",
        "description": "Persistent temporary directory (universal)"
      }
    ]
  },

  "operations": {
    "unlink": {
      "enabled": true,
      "extra_blocked": [],
      "extra_allowed": []
    },
    "rmdir": {
      "enabled": true,
      "extra_blocked": [],
      "extra_allowed": []
    },
    "open_write": {
      "enabled": true,
      "blocked_flags": ["O_WRONLY", "O_RDWR", "O_TRUNC"],
      "extra_blocked": [],
      "extra_allowed": []
    },
    "rename": {
      "enabled": true,
      "check_both_paths": true,
      "extra_blocked": [],
      "extra_allowed": []
    }
  },

  "advanced": {
    "cache_path_checks": true,
    "max_cache_size": 1000,
    "allow_symlink_bypass": false,
    "canonicalize_paths": true,
    "notify_auditd": true,
    "auditd_key": "libwarden_block",
    "allow_env_override": false
  }
}
