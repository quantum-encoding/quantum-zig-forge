<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- Allow systemd service to own the name (controlled by BusName= in unit file) -->
  <policy context="default">
    <allow own="org.jesternet.Chronos"/>
  </policy>

  <!-- Allow all users to call methods (unprivileged access) -->
  <policy context="default">
    <allow send_destination="org.jesternet.Chronos"
           send_interface="org.jesternet.Chronos"
           send_member="GetTick"/>
    <allow send_destination="org.jesternet.Chronos"
           send_interface="org.jesternet.Chronos"
           send_member="NextTick"/>
    <allow send_destination="org.jesternet.Chronos"
           send_interface="org.jesternet.Chronos"
           send_member="GetPhiTimestamp"/>
    <allow send_destination="org.jesternet.Chronos"
           send_interface="org.jesternet.Chronos"
           send_member="LogEvent"/>
    <allow send_destination="org.jesternet.Chronos"
           send_interface="org.freedesktop.DBus.Introspectable"
           send_member="Introspect"/>
  </policy>

  <!-- Only root can shutdown the daemon -->
  <policy user="root">
    <allow send_destination="org.jesternet.Chronos"
           send_interface="org.jesternet.Chronos"
           send_member="Shutdown"/>
  </policy>
</busconfig>
