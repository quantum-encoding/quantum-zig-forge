{
  "profile_name": "forge-untrusted-compiler-net",
  "description": "THE UNCHAINED CRUCIBLE - Compiler execution with network access for dependency fetching (cargo, npm, go mod)",
  "version": "1.0.0",
  "author": "JesterNet Quantum Forge",
  "threat_model": "Untrusted code compilation with dependency fetching - HIGHEST PRIVILEGE PROFILE - Use with caution",

  "syscalls": {
    "default_action": "kill",
    "comment": "Default to SECCOMP_RET_KILL - any unlisted syscall terminates process",

    "allowed": [
      "read",
      "write",
      "open",
      "openat",
      "close",
      "stat",
      "fstat",
      "lstat",
      "newfstatat",
      "statx",
      "access",
      "faccessat",
      "faccessat2",
      "readlink",
      "readlinkat",
      "llistxattr",
      "getcwd",
      "chdir",
      "fchdir",
      "getdents",
      "getdents64",
      "lseek",
      "dup",
      "dup2",
      "dup3",
      "pipe",
      "pipe2",
      "ioctl",
      "fcntl",
      "flock",
      "fsync",
      "fdatasync",
      "truncate",
      "ftruncate",
      "getrlimit",
      "setrlimit",
      "prlimit64",
      "getrusage",
      "umask",
      "gettimeofday",
      "clock_gettime",
      "clock_getres",
      "clock_nanosleep",
      "nanosleep",
      "time",
      "times",
      "getpid",
      "gettid",
      "getppid",
      "getuid",
      "geteuid",
      "getgid",
      "getegid",
      "getgroups",
      "setuid",
      "setgid",
      "setgroups",
      "getresuid",
      "getresgid",
      "setresuid",
      "setresgid",
      "getpgid",
      "setpgid",
      "getpgrp",
      "setsid",
      "getsid",
      "capget",
      "capset",
      "prctl",
      "arch_prctl",
      "mmap",
      "munmap",
      "mremap",
      "mprotect",
      "madvise",
      "brk",
      "mlock",
      "munlock",
      "mlockall",
      "munlockall",
      "mincore",
      "msync",
      "remap_file_pages",
      "rt_sigaction",
      "rt_sigprocmask",
      "rt_sigreturn",
      "rt_sigpending",
      "rt_sigtimedwait",
      "rt_sigsuspend",
      "sigaltstack",
      "uname",
      "getrandom",
      "sysinfo",
      "futex",
      "set_tid_address",
      "set_robust_list",
      "get_robust_list",
      "exit",
      "exit_group",
      "wait4",
      "waitid",
      "poll",
      "ppoll",
      "select",
      "pselect6",
      "epoll_create",
      "epoll_create1",
      "epoll_ctl",
      "epoll_wait",
      "epoll_pwait",
      "epoll_pwait2",
      "eventfd",
      "eventfd2",
      "signalfd",
      "signalfd4",
      "timerfd_create",
      "timerfd_settime",
      "timerfd_gettime",
      "clone",
      "clone3",
      "fork",
      "vfork",
      "sched_yield",
      "sched_getaffinity",
      "sched_setaffinity",
      "sched_getparam",
      "sched_setparam",
      "sched_getscheduler",
      "sched_setscheduler",
      "sched_get_priority_max",
      "sched_get_priority_min",
      "sched_rr_get_interval",
      "restart_syscall",
      "pread64",
      "pwrite64",
      "readv",
      "writev",
      "preadv",
      "pwritev",
      "preadv2",
      "pwritev2",
      "sendfile",
      "copy_file_range",
      "rseq",
      "execve",
      "execveat",
      "faccessat",
      "memfd_create",
      "mkdir",
      "mkdirat",
      "unlink",
      "unlinkat",
      "chmod",
      "fchmod",
      "fchmodat",
      "rename",
      "renameat",
      "renameat2",
      "socket",
      "socketpair",
      "bind",
      "listen",
      "accept",
      "accept4",
      "connect",
      "getsockname",
      "getpeername",
      "sendto",
      "recvfrom",
      "sendmsg",
      "recvmsg",
      "sendmmsg",
      "recvmmsg",
      "shutdown",
      "setsockopt",
      "getsockopt",
      "membarrier",
      "symlink",
      "symlinkat"
    ],

    "blocked": [
      "rmdir",
      "link",
      "linkat",
      "mknod",
      "mknodat",
      "chown",
      "fchown",
      "lchown",
      "fchownat",
      "mount",
      "umount",
      "umount2",
      "pivot_root",
      "chroot",
      "acct",
      "swapon",
      "swapoff",
      "reboot",
      "kexec_load",
      "kexec_file_load",
      "init_module",
      "finit_module",
      "delete_module",
      "iopl",
      "ioperm",
      "create_module",
      "query_module",
      "quotactl",
      "nfsservctl",
      "getpmsg",
      "putpmsg",
      "afs_syscall",
      "tuxcall",
      "security",
      "vserver",
      "bpf",
      "userfaultfd",
      "perf_event_open",
      "ptrace",
      "process_vm_readv",
      "process_vm_writev",
      "kcmp",
      "personality"
    ]
  },

  "capabilities": {
    "comment": "Drop all Linux capabilities - process runs as unprivileged user",
    "drop_all": true,
    "keep": []
  },

  "filesystem": {
    "comment": "Compilers can read system libraries and write to sandbox - network enabled for dependency fetching",
    "protected_paths": [
      "/boot/",
      "/sys/",
      "/proc/sys/"
    ],
    "writable_sandbox": [
      "/tmp/",
      "/home/founder/sandbox/",
      "/home/founder/tmp/",
      "/home/founder/agent_sandboxes/",
      "/home/founder/crucible/",
      "/var/tmp/",
      "/home/founder/.cargo/",
      "/home/founder/.rustup/"
    ]
  },

  "limits": {
    "comment": "Resource limits for compilation with network access",
    "max_open_files": 4096,
    "max_memory_mb": 12288,
    "max_cpu_time_sec": 1200,
    "max_processes": 512
  },

  "metadata": {
    "created": "2025-10-19",
    "forged_by": "JesterNet Quantum Encoding Doctrine",
    "doctrine": "THE UNCHAINED CRUCIBLE - Doctrine of Graduated Sanction",
    "tested_with": ["cargo", "npm", "go mod", "git"],
    "use_cases": [
      "Building Rust projects with cargo (fetches from crates.io)",
      "Installing npm packages with network access",
      "Go module downloads (go mod download)",
      "Git cloning and submodule updates",
      "Any compiler workflow requiring network dependency resolution"
    ],
    "security_implications": [
      "⚠️ NETWORK ACCESS GRANTED - Process can connect to internet",
      "✅ Still sandboxed to workspace - cannot modify system files",
      "✅ Cannot escalate privileges or load kernel modules",
      "✅ Cannot use ptrace or access other processes",
      "⚠️ Can download and execute code from package registries",
      "⚠️ Trust the source code being compiled - AI-generated code may attempt malicious network activity"
    ],
    "known_limitations": [
      "Subprocess creation allowed (compilers spawn multiple processes)",
      "Network enabled - CAN fetch dependencies from internet",
      "Increased resource limits (12GB RAM, 512 processes)",
      "Writes allowed to ~/.cargo and ~/.rustup for dependency caching"
    ],
    "when_to_use": [
      "Building Rust projects that declare dependencies in Cargo.toml",
      "Installing Node.js packages from npm registry",
      "Go projects using external modules",
      "Any build process requiring network dependency resolution"
    ],
    "when_not_to_use": [
      "Compiling standalone files with no dependencies (use compiler-safe instead)",
      "Running untrusted code in air-gapped environments",
      "When network access to package registries is a security concern"
    ]
  }
}
